---
layout: post
title: "iOSé¡¹ç›®ä½¿ç”¨GitLabçš„CI"
description: "Gitlabè‡ªå¸¦CIï¼Œæ–‡ç« ä¸»è¦è®²è§£å¦‚ä½•åœ¨gitlabä¸Šä½¿ç”¨iOSçš„CI"
tag: swift,CI, iOS
---

[TOC]

> è¿™ç¯‡æ–‡ç« å¤§éƒ¨åˆ†æ¥è‡ªè°·æ­Œç¿»è¯‘ï¼æˆ‘åªæ˜¯è®©ä»–æ›´é€šé¡ºå¹¶åŠ ä¸Šè‡ªå·±æ„å»ºä¸­é‡åˆ°é—®é¢˜çš„è§£å†³æ–¹æ³•ã€‚æ–‡ä¸­å›¾ç‰‡å’Œé…ç½®

[åŸæ–‡åœ°å€](https://about.gitlab.com/blog/2016/03/10/setting-up-gitlab-ci-for-ios-projects/)

# ä»¥ä¸‹æ˜¯æ­£æ–‡
åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†é€æ­¥å‘æ‚¨å±•ç¤ºå¦‚ä½•ä¸ºæ‚¨çš„iOSé¡¹ç›®è®¾ç½®GitLab CIã€‚

## ä¸ºä»€ä¹ˆé€‰æ‹©CIï¼Ÿ
[æŒç»­é›†æˆ](https://en.wikipedia.org/wiki/Continuous_integration)ï¼ˆCIï¼‰æ˜¯å¸®åŠ©å¼€å‘äººå‘˜æé«˜ç”Ÿäº§åŠ›å’Œç¼–å†™æ›´é«˜è´¨é‡ä»£ç çš„ç»ä½³å·¥å…·ã€‚é€šè¿‡åœ¨æ¯æ¬¡æäº¤æ—¶è‡ªåŠ¨è¿è¡Œä¸€å¥—æµ‹è¯•ï¼Œæ¯ä¸ªäººéƒ½å¯ä»¥çœ‹åˆ°å¯¹ä»£ç åº“æ‰€åšæ›´æ”¹çš„ç»“æœï¼Œå¹¶é‡‡å–æªæ–½ä½¿é›†æˆå˜å¾—æ›´å¿«ï¼Œæ›´å®¹æ˜“ã€‚

GitLab å…è´¹ä¸ºæ‰€æœ‰é¡¹ç›®[å†…ç½®CI](https://about.gitlab.com/product/continuous-integration/)ã€‚

æœ‰å…³CIçš„æœ€ä½³å®è·µï¼Œå·¥ä½œæµä»¥åŠä¼˜ç¼ºç‚¹çš„è¯¦ç»†ä¿¡æ¯è¶…å‡ºäº†æœ¬æ•™ç¨‹çš„èŒƒå›´ã€‚ç®€è€Œè¨€ä¹‹ï¼Œä¸ºXcodeé¡¹ç›®å¯ç”¨å®ƒæ—¶ï¼Œä¼šå‘ç”Ÿä»¥ä¸‹æƒ…å†µï¼š

1. æ‚¨å¯¹ä»£ç åº“çš„å‰¯æœ¬è¿›è¡Œæ›´æ”¹ï¼Œç„¶åå°†æäº¤æ¨é€åˆ°GitLabã€‚
2. GitLabè¯†åˆ«å‡ºä»£ç åº“å·²æ›´æ”¹ã€‚
3. GitLabä½¿ç”¨æ‚¨åœ¨Macä¸Šä¸ºè¯¥é¡¹ç›®è®¾ç½®çš„GitLab Runnerè§¦å‘æ„å»ºã€‚
4. GitLab Runnerè¿è¡Œæ‚¨åœ¨ä¸­æŒ‡å®šçš„æ„å»ºå’Œæµ‹è¯•è¿‡ç¨‹**.gitlab-ci.yml**ã€‚
5. GitLab Runnerå°†å…¶ç»“æœæŠ¥å‘Šå›GitLabã€‚
6. GitLabå‘æ‚¨æ˜¾ç¤ºæ„å»ºç»“æœã€‚
è¿™ç¯‡æ–‡ç« å»ºç«‹åœ¨[Jeremy Whiteçš„åšå®¢](http://www.thejeremywhite.com/blog/2015/10/05/xcode-gitlab-ci-setup.html)æ–‡ç« çš„åŸºç¡€ä¸Šï¼Œè¿›ä¸€æ­¥ä»‹ç»äº†ä¸€äº›ç»†èŠ‚ï¼Œå¹¶é’ˆå¯¹ä¸‹ä¸€éƒ¨åˆ†ä¸­æè¿°çš„ç¯å¢ƒçº æ­£äº†ä¸€äº›æ­¥éª¤ã€‚


## å‡è®¾ä¸ç¯å¢ƒ
è¿™ç¯‡æ–‡ç« å°†æä¾›ä»å¤´åˆ°å°¾ä¸ºæ‚¨çš„iOSé¡¹ç›®è®¾ç½®GitLab CIçš„åˆ†æ­¥æŒ‡å—ã€‚ä½†æ˜¯ï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åšä¸€äº›å‡è®¾ã€‚

[GitLab's strategy document](https://about.gitlab.com/company/strategy/)å–å†³äºä¸€ä¸ªå…³é”®æ€æƒ³ï¼šæ¯ä¸ªäººéƒ½å¯ä»¥åšå‡ºè´¡çŒ®ã€‚å› æ­¤ï¼Œæœ¬æ–‡æ˜¯ä¸ºå‡ ä¹æ‰€æœ‰ç»éªŒæ°´å¹³çš„è¯»è€…ç¼–å†™çš„ã€‚ä½†æ˜¯ï¼Œé‰´äºCIæ˜¯ä¸€ä¸ªç›¸å¯¹é«˜çº§çš„ä¸»é¢˜ï¼Œæˆ‘ä»¬å°†å‡è®¾æ‚¨å…·æœ‰ä¸€äº›æœ‰å…³å¦‚ä½•åˆ›å»ºXcodeå’ŒGitLabé¡¹ç›®çš„åŸºæœ¬çŸ¥è¯†ï¼Œä»¥åŠå¯¹Terminalå’Œgitçš„ä¸€äº›ç†Ÿæ‚‰ã€‚

æ’°å†™æœ¬æ–‡æ—¶è€ƒè™‘äº†ä»¥ä¸‹å¼€å‘ç¯å¢ƒï¼š

* è¿è¡ŒOS X 10.11.3 El Capitançš„Mac
* å¸¦æœ‰å‘½ä»¤è¡Œå·¥å…·çš„Xcode 7.2.1å’Œå·²å®‰è£…çš„iOS 9.2 SDK
* GitLab.com v8.5

æˆ‘ä»¬è¿˜å°†å‡è®¾æ‚¨å·²ç»åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„GitLabé¡¹ç›®ã€‚å¦‚æœè¿˜æ²¡æœ‰ï¼Œè¯·ç«‹å³æ‰§è¡Œã€‚

## è®¾ç½®æ‚¨çš„Xcodeé¡¹ç›®
æˆ‘ä»¬å°†ä»åœ¨Xcodeä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„å•è§†å›¾iOSé¡¹ç›®å¼€å§‹ã€‚

åˆ›å»ºä¸€ä¸ªæ–°çš„Xcodeé¡¹ç›®ã€‚

<img src="/images/iOSCI/1.png" alt="image">
ä¸ºæ‚¨çš„é¡¹ç›®å‘½åï¼Œå¹¶ç¡®ä¿ä¸ºè¯¥é¡¹ç›®å¯ç”¨äº†â€œ**Include Unit Tests**â€å’Œâ€œ**Include UI Tests**â€é€‰é¡¹ã€‚Xcodeå°†åˆ›å»ºå¸¦æœ‰ä¸€äº›ç¤ºä¾‹æµ‹è¯•çš„æ¨¡æ¿æµ‹è¯•ç±»ï¼Œåœ¨æœ¬æ–‡ä¸­æˆ‘ä»¬å°†ä½¿ç”¨å®ƒä»¬ä½œä¸ºGitLab CIè¿è¡Œä»¥éªŒè¯æ„å»ºçš„æµ‹è¯•å¥—ä»¶ã€‚ä¸ºæ‚¨çš„é¡¹ç›®é€‰æ‹©ä¸€ä¸ªåç§°ï¼Œç„¶åå•å‡»**Next**ã€‚

<img src="/images/iOSCI/2.png" alt="image">
åœ¨é¡¹ç›®ä¸­å¯ç”¨å•å…ƒå’ŒUIæµ‹è¯•

é€‰æ‹©ä¿å­˜iOSé¡¹ç›®çš„ä½ç½®ã€‚å¦‚æœæ„¿æ„ï¼Œè®©Xcodeåœ¨Macä¸Šåˆ›å»ºgitå­˜å‚¨åº“ã€‚

<img src="/images/iOSCI/3.png" alt="image">

Xcodeåˆ›å»ºå¹¶æ‰“å¼€æ‚¨çš„iOSé¡¹ç›®åï¼Œæ‚¨éœ€è¦[å…±äº«schemes](https://developer.apple.com/library/ios/recipes/xcode_help-scheme_editor/Articles/SchemeShare.html)ã€‚è‹¹æœçš„æ–‡æ¡£å¾ˆå¥½åœ°å®šä¹‰äº†schemesï¼š

> æ–¹æ¡ˆæ˜¯è®¾ç½®çš„é›†åˆï¼Œè¿™äº›è®¾ç½®æŒ‡å®šå¯åŠ¨ç›®æ ‡æŒ‡å®šçš„äº§å“æ—¶è¦æ„å»ºçš„ç›®æ ‡ï¼Œè¦ä½¿ç”¨çš„æ„å»ºé…ç½®ä»¥åŠè¦ä½¿ç”¨çš„å¯æ‰§è¡Œç¯å¢ƒã€‚

é€šè¿‡å…±äº«æ‚¨çš„æ–¹æ¡ˆï¼ŒGitLab CIè·å¾—äº†æ„å»ºå’Œæµ‹è¯•é¡¹ç›®æ‰€éœ€çš„ä¸Šä¸‹æ–‡ã€‚

è¦åœ¨Xcodeä¸­å…±äº«æ–¹æ¡ˆï¼Œè¯·é€‰æ‹©**Product** > **Scheme** > **Manage Schemes**

<img src="/images/iOSCI/4.png" alt="image">
å•å‡»**å…³é—­**æŒ‰é’®ã€‚

æ‚¨çš„Xcodeé¡¹ç›®å·²ä½¿ç”¨ä¸¤ä¸ªæµ‹è¯•æ–‡ä»¶åˆ›å»ºï¼›ä¸€ä¸ªåŒ…å«æ ·æœ¬å•å…ƒæµ‹è¯•ï¼Œå¦ä¸€ä¸ªåŒ…å«æ ·æœ¬UIæµ‹è¯•ã€‚æ‚¨å¯ä»¥è¿è¡Œ**Product** > **Test** æ¥è¿è¡Œè¿™äº›æµ‹è¯•ï¼Œè¿™å°†æ„å»ºæ‚¨çš„é¡¹ç›®ï¼Œå¯åŠ¨æ¨¡æ‹Ÿå™¨ï¼Œåœ¨Simulatorè®¾å¤‡ä¸Šå®‰è£…é¡¹ç›®ï¼Œç„¶åè¿è¡Œæµ‹è¯•å¥—ä»¶ã€‚æ‚¨å¯ä»¥åœ¨Xcodeä¸­ç›´æ¥çœ‹åˆ°ç»“æœï¼š

<img src="/images/iOSCI/5.png" alt="image">

æµ‹è¯•åŠŸèƒ½æ—è¾¹çš„ç»¿è‰²å¤é€‰æ ‡è®°ï¼ˆåœ¨æ–‡ä»¶ä¸­å’Œåœ¨â€œæµ‹è¯•â€å¯¼èˆªå™¨ä¸­ï¼‰å‡è¡¨ç¤ºæ‰€æœ‰æµ‹è¯•å‡å·²é€šè¿‡ã€‚æˆ‘ä»¬å°†ä¸å†å¼•ç”¨Xcodeé¡¹ç›®ï¼Œå› æ­¤ï¼Œå¦‚æœæ‚¨æ„¿æ„ï¼Œå¯ä»¥å°†å…¶å…³é—­ã€‚

æ¥ä¸‹æ¥ï¼Œæ‰“å¼€ç»ˆç«¯å¹¶å¯¼èˆªåˆ°ä¸ºiOSé¡¹ç›®åˆ›å»ºçš„æ–‡ä»¶å¤¹ã€‚

æ·»åŠ æ ‡å‡†**.gitignore**æ–‡ä»¶å¾ˆæ–¹ä¾¿ã€‚å¯¹äºSwifté¡¹ç›®ï¼Œè¾“å…¥ï¼š

```
$ curl -o .gitignore https://www.gitignore.io/api/swift
```
å¯¹äºObjective-Cé¡¹ç›®ï¼Œè¾“å…¥ï¼š

```
$ curl -o .gitignore https://www.gitignore.io/api/objective-c
```
**curl**å‘½ä»¤å¯æ–¹ä¾¿åœ°å°†ç»™å®š[gitignore.io](https://gitignore.io/) çš„URLä¸‹çš„é¡µé¢å†…å®¹ä¸‹è½½åˆ°åä¸º**.gitignore**çš„æ–‡ä»¶ä¸­ã€‚

å¦‚æœXcodeä¸ºæ‚¨åˆå§‹åŒ–äº†gitå­˜å‚¨åº“ï¼Œåˆ™éœ€è¦å°†åŸå§‹ç½‘å€è®¾ç½®ä¸ºæ‚¨çš„GitLabé¡¹ç›®ï¼ˆç”¨<username>æ‚¨çš„GitLabç”¨æˆ·åå’Œ<project>é¡¹ç›®åç§°æ›¿æ¢ï¼‰ï¼š

```
$ git remote add origin git@gitlab.com:<username>/<project>.git
```
è¿™é‡Œçš„æœ€åä¸€æ­¥æ˜¯å®‰è£…[xcpretty](https://github.com/supermarin/xcpretty)ã€‚å½“Xcodeæ„å»ºå’Œæµ‹è¯•æ‚¨çš„é¡¹ç›®æ—¶ï¼Œxcprettyä¼šå°†è¾“å‡ºè½¬æ¢ä¸ºæ‚¨æ›´æ˜“è¯»çš„å†…å®¹ã€‚

## å®‰è£…å’Œæ³¨å†ŒGitLab Runner
GitLab Runneræ˜¯Macä¸Šå®‰è£…çš„ä¸€é¡¹æœåŠ¡ï¼Œå®ƒè¿è¡Œæ‚¨åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®çš„æ„å»ºå’Œæµ‹è¯•è¿‡ç¨‹ã€‚æ‚¨å¯ä»¥æŒ‰ç…§[OS Xçš„å®‰è£…è¯´æ˜è¿›è¡Œæ“ä½œ](https://gitlab.com/gitlab-org/gitlab-runner/blob/master/docs/install/osx.md)ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦å¯¹*æ³¨å†Œè¿è¡Œç¨‹åº*æ­¥éª¤è¿›è¡Œä¸€äº›æ›´æ”¹ï¼š


```
$ gitlab-ci-multi-runner register
WARNING: Running in user-mode.                     
WARNING: The user-mode requires you to manually start builds processing:
WARNING: $ gitlab-runner run                       
WARNING: Use sudo for system-mode:                 
WARNING: $ sudo gitlab-runner...  
```                 

å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯è‡ªæ‰˜ç®¡çš„GitLabï¼Œåˆ™åè°ƒå™¨URLå°†ä¸ºhttp(s)://url-of-your-gitlab-instance/ciã€‚

```
Please enter the gitlab-ci coordinator URL (e.g. https://gitlab.com/ci):
https://gitlab.com/ci
```
æ‚¨çš„é¡¹ç›®çš„CIä»¤ç‰Œå¯åœ¨GitLabçš„â€œé¡¹ç›®è®¾ç½®â€é¡µé¢ä¸Šçš„*Advanced Settings*ä¸‹æ‰¾åˆ°ã€‚æ¯ä¸ªé¡¹ç›®éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ä»¤ç‰Œã€‚

```
Please enter the gitlab-ci token for this runner:
<CI runner token from Project > Settings > Runner>
```
è¯¥**register**è¿‡ç¨‹ä¼šå»ºè®®æ‚¨ä½¿ç”¨Macçš„åç§°ä½œä¸ºRunnerçš„æè¿°ã€‚æ‚¨å¯ä»¥æ ¹æ®éœ€è¦è¾“å…¥å…¶ä»–å†…å®¹ï¼Œä¹Ÿå¯ä»¥æŒ‰å›è½¦é”®ç»§ç»­ã€‚
```
Please enter the gitlab-ci description for this runner:
[Your-Mac's-Name.local]:
```
è¾“å…¥æ‚¨æƒ³è¦çš„æ ‡ç­¾ï¼Œä»¥è¿›ä¸€æ­¥è¯†åˆ«è¯¥ç‰¹å®šRunnerã€‚å½“æ‚¨éœ€è¦ç‰¹å®šçš„æ„å»ºç¯å¢ƒæ—¶ï¼Œå®ƒç‰¹åˆ«æœ‰ç”¨.ä¾‹å¦‚ï¼ŒiOS9.2,Xcode 7.2,OS X 10.11å¯ä»¥ä½¿ç”¨æ ‡ç­¾ios_9-2ï¼Œxcode_7-2å’Œosx_10-11ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å·¥å…·é“¾ï¼Œå¹³å°ç­‰åœ¨GitLabä¸­è¿‡æ»¤æ„å»ºé˜¶æ®µã€‚

```
Please enter the gitlab-ci tags for this runner (comma separated):
ios_9-2, xcode_7-2, osx_10-11
```
GitLabè¿è¡Œç¨‹åºå°†æ³¨å†Œè¿è¡Œç¨‹åºå¹¶ä¸ºå…¶æä¾›å”¯ä¸€çš„runnerIDã€‚

```
Registering runner... succeeded                     runner=s8Bgtktb
```
GitLab Runnerå¿…é¡»è¿è¡Œxcodebuildæ‰èƒ½æ„å»ºå’Œæµ‹è¯•é¡¹ç›®ï¼Œå› æ­¤æˆ‘ä»¬é€‰æ‹©shellä½œä¸ºæ‰§è¡Œè€…ï¼š

```
Please enter the executor: virtualbox, ssh, shell, parallels, docker, docker-ssh:
shell
Runner registered successfully. Feel free to start it, but if it's running
already the config should be automatically reloaded!
```
æ ¹æ®æ–‡æ¡£ï¼Œç»§ç»­æ‰§è¡ŒRunnerå®‰è£…è¯´æ˜çš„å…¶ä½™éƒ¨åˆ†ï¼ˆ**install**å’Œ**start**ï¼‰ã€‚

è½¬åˆ°â€œ é¡¹ç›®è®¾ç½®â€ä¸­çš„â€œ Runnerâ€é¡µé¢ï¼Œç„¶åï¼š

<img src="/images/iOSCI/6.png" alt="image">

GitLab Runneråœ¨GitLabçš„é¡¹ç›®è®¾ç½®ä¸­å¾—åˆ°è®¤å¯ã€‚

æ‚¨çš„GitLab Runnerå·²è¢«è¯†åˆ«ï¼Œå¹¶ä¸”ï¼ˆå‡ ä¹ï¼‰å·²å‡†å¤‡å°±ç»ªï¼

æ‚¨å¯ä»¥é€šè¿‡è¿è¡Œæ¥éªŒè¯

```
$ gitlab-ci-multi-runner verify
WARNING: Running in user-mode.                     
WARNING: The user-mode requires you to manually start builds processing:
WARNING: $ gitlab-runner run                       
WARNING: Use sudo for system-mode:                 
WARNING: $ sudo gitlab-runner...                   

Veryfing runner... is alive                         runner=25c780b3
```
è¯·æ³¨æ„ï¼Œå®ƒä»¬å…·æœ‰ç›¸åŒçš„IDï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸º25c780b3ï¼‰ã€‚

æœ€åè¦åšçš„æ˜¯é…ç½®æ„å»ºå’Œæµ‹è¯•è®¾ç½®ã€‚ä¸ºæ­¤ï¼Œæ‰“å¼€æ‚¨çš„æ–‡æœ¬ç¼–è¾‘å™¨å¹¶è¾“å…¥ä»¥ä¸‹å†…å®¹ï¼š

```
stages:
  - build

build_project:
  stage: build
  script:
    - xcodebuild clean -project ProjectName.xcodeproj -scheme SchemeName | xcpretty
    - xcodebuild test -project ProjectName.xcodeproj -scheme SchemeName -destination 'platform=iOS Simulator,name=iPhone 6s,OS=9.2' | xcpretty -s
  tags:
    - ios_9-2
    - xcode_7-2
    - osx_10-11
```
å°†æ­¤æ–‡ä»¶ä¿å­˜ä¸ºXcodeé¡¹ç›®æ–‡ä»¶å¤¹ä¸­çš„**.gitlab-ci.yml**ï¼Œä¸è¦å¿˜è®°æ–‡ä»¶åå¼€å¤´çš„å¥ç‚¹ï¼

> æ›´æ–°ï¼šä¸ºæ˜ç¡®èµ·è§ï¼Œè¯¥**.gitlab-ci.yml**æ–‡ä»¶åº”æ”¾å…¥æ‚¨ä¸ºiOSé¡¹ç›®åˆ›å»ºçš„æ–‡ä»¶å¤¹ä¸­ï¼Œè¯¥æ–‡ä»¶å¤¹é€šå¸¸ä¹Ÿä½äºXcodeé¡¹ç›®æ–‡ä»¶ï¼ˆ**ProjectName.xcodeproj**ï¼‰æ‰€åœ¨çš„ä½ç½®ã€‚æ„Ÿè°¢è¯„è®ºå‘˜PaloæŒ‡å‡ºè¿™ä¸€ç‚¹ï¼

> > è¿™ä¸ªåå­—å…¶å®æ˜¯å¯ä»¥è‡ªå®šä¹‰åå­—å’Œä½ç½®çš„
> > ![å±å¹•å¿«ç…§ 2019-11-20 ä¸‹åˆ1.53.05](media/15742289516042/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202019-11-20%20%E4%B8%8B%E5%8D%881.53.05.png)
> > <img src="/images/iOSCI/7.png" alt="image">

> > å½“ç„¶ï¼Œå¦‚æœä½ è¿™æ ·æ”¾çš„è¯ï¼Œå®é™…æ‰§è¡Œçš„æ—¶å€™ï¼ŒGitLabåˆ°å“åº”ä½ç½®(å›¾ç¤ºä¸ºSources/.gitlab-ci.yml)æ‰¾åˆ°ymlæ–‡ä»¶ï¼Œç„¶ååœ¨æœ€å¤–å±‚æ–‡ä»¶å¤¹æ‰¾xx.xcodeprojæ–‡ä»¶ï¼Œå½“ç„¶æ˜¯æ‰¾ä¸åˆ°çš„ã€‚æ‰€ä»¥ä½ è¦åœ¨scripté‡Œé¢æŒ‡å®šåˆ°å“åº”æ–‡ä»¶å¤¹
>> 
>> ```
>> ...
>> stage: build
    script:
        - cd Sources
        - xcodebuild clean -project CIDemo.xcodeproj -scheme CIDemo | xcpretty
...
>> ```


è®©æˆ‘ä»¬è¯¦ç»†äº†è§£ä¸€ä¸‹è¯¥æ–‡ä»¶ï¼š

* è¯¥æ–‡ä»¶é¦–å…ˆæè¿°äº†**stages**æ¯ä¸ªæ–‡ä»¶å¯ç”¨çš„æ–‡ä»¶**job**ã€‚ä¸ºç®€å•èµ·è§ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªé˜¶æ®µï¼ˆ**build**ï¼‰å’Œä¸€ä¸ªå·¥ä½œï¼ˆ**build_project**ï¼‰ã€‚
* è¯¥æ–‡ä»¶ä¸ºæ¯ä¸ªæ–‡ä»¶æä¾›è®¾ç½®**job**ã€‚è¯¥**build_project**ä½œä¸šè¿è¡Œä¸¤ä¸ªè„šæœ¬ï¼šä¸€ä¸ªç”¨äºæ¸…ç†Xcodeé¡¹ç›®ï¼Œç„¶åå¦ä¸€ä¸ªç”¨äºæ„å»ºå’Œæµ‹è¯•å®ƒã€‚æ‚¨å¯èƒ½å¯ä»¥è·³è¿‡æ¸…ç†è„šæœ¬ä»¥èŠ‚çœæ—¶é—´ï¼Œé™¤éæ‚¨è¦ç¡®ä¿ä»æ¸…ç†çŠ¶æ€å¼€å§‹æ„å»ºã€‚
* åœ¨**tags**ä¸‹æ–¹ï¼Œæ·»åŠ **æ‚¨æ³¨å†ŒGitLab Runneræ—¶åˆ›å»ºçš„æ ‡ç­¾**ã€‚

è¿˜æœ‰ä¸€äº›æ³¨æ„äº‹é¡¹ï¼š

* ç¡®ä¿å°†æ‰€æœ‰å¼•ç”¨æ›¿æ¢ProjectNameä¸ºæ‚¨çš„Xcodeé¡¹ç›®çš„åç§°ï¼›å¦‚æœæ‚¨ä½¿ç”¨çš„æ–¹æ¡ˆä¸é»˜è®¤æ–¹æ¡ˆä¸åŒï¼Œè¯·ç¡®ä¿æ‚¨**SchemeName**ä¹Ÿè¾“å…¥æ­£ç¡®çš„æ–¹æ¡ˆï¼ˆé»˜è®¤æ–¹æ¡ˆä¸ç›¸åŒ**ProjectName**ï¼‰ã€‚
* åœ¨**xcodebuild test**å‘½ä»¤ä¸­ï¼Œè¯·æ³¨æ„ï¼Œè¯¥-destinationé€‰é¡¹å·²è®¾ç½®ä¸ºåœ¨Simulatorä¸­å¯åŠ¨è¿è¡ŒiOS 9.2çš„iPhone 6Så›¾åƒï¼›å¦‚æœæ‚¨è¦è¿è¡Œå…¶ä»–è®¾å¤‡ï¼ˆä¾‹å¦‚iPadï¼‰ï¼Œåˆ™éœ€è¦è¿›è¡Œæ›´æ”¹ã€‚
* å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯å·¥ä½œåŒºè€Œä¸æ˜¯é¡¹ç›®ï¼ˆä¾‹å¦‚ï¼Œå› ä¸ºæ‚¨çš„åº”ç”¨ç¨‹åºä½¿ç”¨**Cocoapods**ï¼‰ï¼Œè¯·å°†**-project ProjectName.xcodeproj** é€‰é¡¹æ›´æ”¹ä¸º**-workspace WorkspaceName.xcworkspace**ã€‚xcodebuildæœ‰å¤šç§é€‰é¡¹å¯ç”¨äºè‡ªå®šä¹‰æ„å»ºã€‚åœ¨ç»ˆç«¯ä¸­è¿è¡Œ**xcodebuild --help**ä»¥è¿›ä¸€æ­¥æ¢ç´¢è¿™äº›å†…å®¹ã€‚
* å…³äºtagsï¼Œéœ€è¦ä¿è¯Runnerçš„æ ‡ç­¾å’Œ**.gitlab-ci.yml**æ–‡ä»¶å†…çš„æ ‡ç­¾ä¸€è‡´ï¼Œå¦åˆ™Gitlabä¼šæ‰¾ä¸åˆ°ç‰¹å®šçš„Runnerå¯¼è‡´æ— æ³•æ‰§è¡Œã€‚

GitLabæä¾›äº†ä¸€ä¸ªç®€å•çš„å·¥å…·å¯ä»¥â€œæ•´ç†â€ï¼ˆæˆ–è€…éªŒè¯ï¼‰.gitlab-ci.ymlæ–‡ä»¶ã€‚åœ¨æ‚¨çš„GitLabé¡¹ç›®é¡µé¢ä¸Šï¼Œå•å‡»ä¾§è¾¹æ ä¸­çš„Buildsï¼Œç„¶ååœ¨å³ä¸Šè§’å•å‡»**CI Lint**ï¼š

<img src="/images/iOSCI/8.png" alt="image">

å°†**.gitlab-ci.yml**æ–‡ä»¶å†…å®¹ç²˜è´´åˆ°æ–‡æœ¬æ¡†ä¸­ï¼Œç„¶åå•å‡»**Validate**ã€‚æ‚¨åº”è¯¥çœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹å†…å®¹ï¼š

> Status: syntax is correct

è¿™ä¸ä¼šå‘Šè¯‰æ‚¨é¡¹ç›®åç§°æˆ–æ‰€é€‰çš„æ¨¡æ‹Ÿå™¨æ˜¯å¦æ­£ç¡®ï¼Œå› æ­¤è¯·åŠ¡å¿…ä»”ç»†æ£€æŸ¥è¿™äº›è®¾ç½®ã€‚

è¯¥**.gitlab-ci.yml**æ–‡ä»¶æ˜¯é«˜åº¦å¯å®šåˆ¶çš„ã€‚æ‚¨å¯ä»¥å°†ä½œä¸šé™åˆ¶ä¸ºæˆåŠŸæˆ–å¤±è´¥ï¼Œä¹Ÿå¯ä»¥æ ¹æ®åˆ†æ”¯æˆ–æ ‡ç­¾æ¥å†³å®šæ˜¯å¦æ„å»ºï¼Œä½ å¯ä»¥é˜…è¯»[ç®¡é¥­æ–‡æ¡£](http://doc.gitlab.com/ce/ci/yaml/README.html)ä»¥äº†è§£å…¶çµæ´»æ€§å’Œå¼ºå¤§æ€§ã€‚

## è®¾ç½®CIçš„GitLabé¡¹ç›®
å®é™…ä¸Šï¼Œè¿™é‡Œå®é™…ä¸Šæ²¡æœ‰ä»€ä¹ˆå¯åšçš„ï¼é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨æ–°é¡¹ç›®ä¸Šå¯ç”¨CIã€‚å¦‚æœæ‚¨çš„iOSé¡¹ç›®ä¸­æœ‰ä¸€äº›ç¯å¢ƒå˜é‡éœ€è¦ä¿å¯†ï¼Œä½†æ‚¨æƒ³åœ¨GitLabä¸Šå°†è¯¥é¡¹ç›®ä¿æŒå…¬å¼€çŠ¶æ€ï¼Œåˆ™å¯ä»¥åœ¨**é¡¹ç›®è®¾ç½®** > **Continuous Integration**â€ä¸­ç¦ç”¨**Public builds**ã€‚è¿™å°†éšè—é™¤é¡¹ç›®æˆå‘˜ä»¥å¤–çš„æ‰€æœ‰äººçš„æ„å»ºç»“æœã€‚

ä½ å¯èƒ½æƒ³åœ¨ä½ çš„é¡¹ç›®è®¾ç½®ä¸­æ‰¾åˆ°Runnerï¼Œç„¶åç‚¹å‡»**Disable shared runners**ï¼Œä½†æ˜¯è¿™æ˜¯ä¸å¯¹çš„â€”â€”å› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ç‰¹å®šäºé¡¹ç›®çš„Runnerã€‚

æˆ‘ä»¬ç°åœ¨å‡†å¤‡è§¦å‘CIæ„å»ºï¼

## å¦‚ä½•è§¦å‘æ„å»º
è¦è§¦å‘æ„å»ºï¼Œæ‚¨æ‰€è¦åšçš„å°±æ˜¯å°†æäº¤æ¨é€åˆ°GitLabã€‚ä»ç»ˆç«¯ï¼š

```
$ git add .
$ git commit -m "First commit."
[...commit info...]
$ git push origin master
[...push info...]
```
å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œå¹¶ä¸”æ‚¨åœ¨åŒä¸€å°è®¡ç®—æœºä¸Šå®‰è£…äº†GitLab Runnerï¼Œæ‚¨ä¼šæ³¨æ„åˆ°Simulatorå¯åŠ¨ï¼Œå®‰è£…iOSåº”ç”¨å¹¶å¯åŠ¨ï¼Œç„¶åè¿”å›ä¸»å±å¹•ã€‚

è½¬åˆ°æ‚¨çš„GitLabé¡¹ç›®çš„**Builds**é¡µé¢ï¼Œç„¶åæŸ¥çœ‹ç»“æœï¼

<img src="/images/iOSCI/9.png" alt="image">

å•å‡»<span style = colorï¼šgreen>âœ”ï¸ success</ span>æŒ‰é’®ä»¥æŸ¥çœ‹æ„å»ºè¾“å‡ºï¼š

<img src="/images/iOSCI/10.png" alt="image">
åœ¨è¿™é‡Œï¼Œæ‚¨
å°†çœ‹åˆ°.gitlab-ci.yml æ–‡ä»¶ä¸­è¯·æ±‚çš„æ‰€æœ‰æ­¥éª¤çš„è¾“å‡ºã€‚åœ¨æ—¥å¿—çš„åº•éƒ¨ï¼Œæ‚¨åº”è¯¥çœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹å†…å®¹ï¼š

```

All tests
Test Suite GitLab-CI-for-iOSTests.xctest started
GitLab_CI_for_iOSTests
    . testExample (0.001 seconds)
    T testPerformanceExample measured (0.000 seconds)
    . testPerformanceExample (0.324 seconds)


	 Executed 2 tests, with 0 failures (0 unexpected) in 0.325 (0.328) seconds

All tests
Test Suite GitLab-CI-for-iOSUITests.xctest started
GitLab_CI_for_iOSUITests
    . testExample (3.587 seconds)


	 Executed 1 test, with 0 failures (0 unexpected) in 3.587 (3.589) seconds


Build succeeded.
```
ç°åœ¨ï¼Œæ‚¨å¯ä»¥ç»§ç»­ä¸ºä»£ç ç¼–å†™æµ‹è¯•ï¼Œæ¯æ¬¡æ‚¨æäº¤æäº¤æ—¶ï¼ŒGitLabéƒ½ä¼šå‹¤å¥‹åœ°è·å–é¡¹ç›®ï¼Œæ¸…ç†é¡¹ç›®ï¼Œç„¶åè¿›è¡Œæ„å»ºå’Œæµ‹è¯•ã€‚å¦‚æœæ„å»ºå¤±è´¥ï¼Œåˆ™å¯ä»¥é‡‡å–æªæ–½æ¥ä¿®å¤æäº¤ã€‚

## åœ¨Macä¸Šå¯åŠ¨å’Œåœæ­¢Runner
GitLab RunneråŒ…å«å‡ ä¸ªæ–¹ä¾¿çš„å‘½ä»¤ï¼Œæ‚¨å¯ä»¥è½»æ¾åˆ—å‡ºè¿™äº›å‘½ä»¤ï¼š

```
$ gitlab-ci-multi-runner --help
NAME:
   gitlab-ci-multi-runner - a GitLab Runner

USAGE:
   gitlab-ci-multi-runner [global options] command [command options] [arguments...]

VERSION:
   1.0.4 (014aa8c)

AUTHOR(S):
   Kamil TrzciÅ„ski <ayufan@ayufan.eu>

COMMANDS:
   archive	find and archive files (internal)
   artifacts	upload build artifacts (internal)
   extract	extract files from an archive (internal)
   exec		execute a build locally
   list		List all configured runners
   run		run multi runner service
   register	register a new runner
   install	install service
   uninstall	uninstall service
   start	start service
   stop		stop service
   restart	restart service
   status	get status of a service
   run-single	start single runner
   unregister	unregister specific runner
   verify	verify all registered runners
   help, h	Shows a list of commands or help for one command

GLOBAL OPTIONS:
   --debug			debug mode [$DEBUG]
   --log-level, -l "info"	Log level (options: debug, info, warn, error, fatal, panic)
   --help, -h			show help
   --version, -v		print the version

```
æ‚¨å¯èƒ½è¦åœæ­¢Runnerï¼Œä»¥ä¾¿ä¸ä¼šå› æ¨é€çš„æäº¤ç«‹å³è§¦å‘æ„å»ºï¼š

```
$ gitlab-ci-multi-runner stop
$ gitlab-ci-multi-runner status
gitlab-runner: Service is not running.

```
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»»ä½•æ¨é€çš„æ„å»ºéƒ½å°†æ˜¾ç¤ºä¸º**pending**ï¼Œå¹¶åœ¨é‡æ–°å¯åŠ¨Runneråç«‹å³è§¦å‘ï¼š
```
$ gitlab-ci-multi-runner start
$ gitlab-ci-multi-runner status
gitlab-runner: Service is running!

```
è¿™å°†è§¦å‘é˜Ÿåˆ—ä¸­ä»»ä½•**pending**çŠ¶æ€çš„æ„å»ºï¼Œç„¶åå¯åŠ¨Simulatorå¹¶æ­£å¸¸è¿è¡Œæµ‹è¯•å¥—ä»¶ã€‚

### å…¶ä»–ä¸€äº›å¯èƒ½ç”¨åˆ°çš„
**gitlab-ci-multi-runner**è¿™ä¸ªå‘½ä»¤å¤ªé•¿äº†ï¼Œä½ å¯ä»¥åœ¨.zshrcä¸­é…ç½®ä¸€ä¸ªåˆ«å

```
# GitLab-Runner
alias glr="gitlab-ci-multi-runner"
```
åˆ«å¿˜äº†ä½¿ç”¨**source ~/.zshrc**æ¥æ›´æ–°é…ç½®
ä½¿ç”¨çš„æ—¶å€™å°±å¯ä»¥è¿™æ ·ï¼š
```
$ glr start
```

å¸¸ç”¨å‘½ä»¤ï¼š
åˆ—å‡ºå½“å‰æ‰€æœ‰æ³¨å†Œçš„æœºå™¨

```
$ glr list
Listing configured runners                          ConfigFile=/Users/bmac/.gitlab-runner/config.toml
iOSCIDemo                                           Executor=shell Token=562a7c02cb6849942c2cb022fde03e URL=http://172.16.5.31/
```
    
registerå‘½ä»¤å¯ä»¥å°†ä½ çš„ç”µè„‘æ³¨å†Œåˆ°Gitlabç½‘ç«™ä¸Šï¼Œæ­£å¦‚ä¸Šæ–‡æåˆ°çš„ã€‚

unregisterå‘½ä»¤å¯ä»¥ç§»é™¤å½“å‰ç”µè„‘ä¸Šå·²ç»æ³¨å†Œçš„æœºå™¨ï¼Œéœ€è¦æŒ‡å®šéœ€è¦ç§»é™¤çš„tokenå’Œurlã€‚-tæ˜¯--tokençš„ç®€å†™ï¼Œ-uæ˜¯--urlçš„ç®€å†™ã€‚

```
glr unregister -t a60d3845daf5b02fa8833cae68a858 -u http://172.16.5.31/
```

è¿˜æœ‰ä¸€ç§æƒ…å†µï¼šå¦‚æœä½ åœ¨Gitlabä¸Šåˆ é™¤äº†è¿™ä¸ªRunnerï¼Œä½†æ˜¯ç”µè„‘ä¸Šæ²¡æœ‰åˆ é™¤ï¼Œç„¶åä½ å†è¿è¡Œunregisterå‘½ä»¤ï¼Œä½ ä¼šæ”¶åˆ°è¿™ä¸ªæç¤ºï¼š
```
$ glr unregister -t auxdVqH4ysV6gSDAsz3K -u https://gitlab.com/
WARNING: Running in user-mode.
WARNING: Use sudo for system-mode:
WARNING: $ sudo gitlab-runner...

ERROR: Unregistering runner from GitLab forbidden   runner=auxdVqH4
FATAL: Failed to unregister runner
```
è¿™æ˜¯å› ä¸ºç½‘ç«™ä¸Šå·²ç»æ‰¾ä¸åˆ°è¿™ä¸ªRunnerï¼Œæ‰€ä»¥æ— æ³•åˆ é™¤ï¼Œè¿™æ—¶å€™ä½ éœ€è¦ä½¿ç”¨

```
$ glr verify --delete -t auxdVqH4ysV6gSDAsz3K -u https://gitlab.com/
WARNING: Running in user-mode.
WARNING: Use sudo for system-mode:
WARNING: $ sudo gitlab-runner...

ERROR: Verifying runner... is removed               runner=auxdVqH4
Updated /Users/bmac/.gitlab-runner/config.toml
```

é‡å¯æ‰€æœ‰Runner
```
$ glr restart
```
è¿è¡Œä¸€ä¸ªRunner
```
$ glr run-single ...
```
å¼ºåˆ¶å…³é—­æ‰€æœ‰Runner

```
$ sudo killall -SIGHUP gitlab-ci-multi-runner
```

## é«˜çº§ï¼šè‡ªåŠ¨å½’æ¡£é¡¹ç›®
å‡è®¾ï¼Œå¦‚æœæˆ‘ä»¬æäº¤åˆ°**master**åˆ†æ”¯ï¼Œæˆ‘ä»¬å¸Œæœ›GitLab CIä¸ä»…å¯ä»¥æ„å»ºå’Œæµ‹è¯•é¡¹ç›®ï¼Œè€Œä¸”è¿˜å¯ä»¥å…·å¤‡ä¸€äº›è¿ç»­äº¤ä»˜çš„èƒ½åŠ›ï¼Œåœ¨é‚£é‡Œå®ƒåˆ›å»ºäº†ä¸€ä¸ªåº”ç”¨ç¨‹åºå½’æ¡£ï¼Œå¹¶å°†å…¶ä¸Šä¼ åˆ°GitLabã€‚

æˆ‘ä»¬é¦–å…ˆä¿®æ”¹**.gitlab-ci.yml**æ–‡ä»¶ä»¥æ·»åŠ **archive**é˜¶æ®µå’Œ**archive_project**å·¥ä½œï¼š

```
stages:
  - build
  - archive

build_project:
  stage: build
  script:
    - xcodebuild clean -project ProjectName.xcodeproj -scheme SchemeName | xcpretty
    - xcodebuild test -project ProjectName.xcodeproj -scheme SchemeName -destination 'platform=iOS Simulator,name=iPhone 6s,OS=9.2' | xcpretty -s
  tags:
    - ios_9-2
    - xcode_7-2
    - osx_10-11

archive_project:
  stage: archive
  script:
    - xcodebuild clean archive -archivePath build/ProjectName -scheme SchemeName
    - xcodebuild -exportArchive -exportFormat ipa -archivePath "build/ProjectName.xcarchive" -exportPath "build/ProjectName.ipa" -exportProvisioningProfile "ProvisioningProfileName"
  only:
    - master
  artifacts:
    paths:
    - build/ProjectName.ipa
  tags:
    - ios_9-2
    - xcode_7-2
    - osx_10-11
```
è¯¥**archive_project**ä½œä¸šè¿è¡Œä¸¤ä¸ªè„šæœ¬ï¼šç¬¬ä¸€ä¸ªè„šæœ¬æ¸…ç†å¹¶å­˜æ¡£Xcodeé¡¹ç›®ï¼Œç¬¬äºŒä¸ªè„šæœ¬æ„å»º**.ipa**æ–‡ä»¶ã€‚ä¸Šé¢è„šæœ¬é‡Œçš„**only**è®¾ç½®æ„å‘³ç€è¯¥ä½œä¸šä»…åœ¨æˆ‘ä»¬æäº¤åˆ°masteråˆ†æ”¯çš„æ—¶å€™æ‰è¿è¡Œã€‚æ³¨æ„ï¼Œå®ƒä¹Ÿå®šä¹‰äº†**artifacts**ï¼Œåœ¨åˆ›å»ºProjectName.ipaå­˜æ¡£åï¼Œæ­¤é€‰é¡¹ä¼šå°†å…¶ä¸Šä¼ åˆ°GitLabï¼Œæ‚¨ä»¥åå¯ä»¥åœ¨**Build**é¡µé¢ä¸­ä¸‹è½½å®ƒã€‚

åœ¨**archive_project**ä½œä¸šçš„**exportArchive**è„šæœ¬ä¸­ï¼Œç¡®ä¿æ‚¨ä¼ é€’æ­£ç¡®çš„**ProvisioningProfileName**ã€‚å¦‚æœæ‚¨çš„developer keysä½äºç™»å½•é’¥åŒ™ä¸²ä¸­ï¼Œ**archive_project**è¿™ä¸€æ­¥éª¤è¿˜æ˜¯å¯èƒ½ä¼šå¤±è´¥ï¼Œå› ä¸ºæ²¡æœ‰åœ¨è„šæœ¬ä¸­è§£é”ã€‚æ— éœ€åœ¨è„šæœ¬ä¸­è¾“å…¥å¯†ç å³å¯è§£å†³æ­¤é—®é¢˜çš„æœ€ç®€å•æ–¹æ³•æ˜¯åœ¨Macä¸Šæ‰“å¼€â€œé’¥åŒ™ä¸²è®¿é—®â€å¹¶å°†å…¶æ‹–æ”¾åˆ°â€œç³»ç»Ÿé’¥åŒ™ä¸²â€ä¸­ã€‚ğŸ˜·

ç°åœ¨ï¼Œå½“æˆ‘ä»¬æäº¤ä»£ç åˆ°masteråˆ†æ”¯æ—¶ï¼Œè¯¥æ„å»ºè¿˜å°†å‘æˆ‘ä»¬æ˜¾ç¤ºå½’æ¡£åçš„ç»“æœï¼Œä»¥åŠä¸‹è½½æˆ–æµè§ˆæ„å»ºå·¥ä»¶çš„é€‰é¡¹ï¼
<img src="/images/iOSCI/11.png" alt="image">

## å…¶ä»–è¦ç‚¹
* æ­¤å·¥ä½œæµç¨‹é€‚ç”¨äºä»»ä½•ç±»å‹çš„Xcodeé¡¹ç›®ï¼ŒåŒ…æ‹¬tvOSï¼ŒwatchOSå’ŒMac OSXã€‚åªéœ€ç¡®ä¿åœ¨.gitlab-ci.ymlæ–‡ä»¶ä¸­æŒ‡å®šé€‚å½“çš„Simulatorè®¾å¤‡å³å¯ã€‚
* å¦‚æœè¦æ¨é€æäº¤ä½†ä¸æƒ³è§¦å‘CIæ„å»ºï¼Œåªéœ€å°†å…¶æ·»åŠ **[ci skip]**åˆ°æäº¤æ¶ˆæ¯ä¸­å³å¯ã€‚
* å¦‚æœå®‰è£…äº†GitLabè¿è¡Œç¨‹åºçš„ç”¨æˆ·æœªç™»å½•ï¼Œåˆ™Runnerå°†ä¸ä¼šè¿è¡Œã€‚å› æ­¤ï¼Œå¦‚æœpendingçŠ¶æ€æ—¶é—´è¿‡é•¿ï¼Œæ‚¨å¯èƒ½éœ€è¦æ£€æŸ¥ä¸€ä¸‹é…ç½®ï¼
* å¦‚æœæ‚¨åœ¨å›¢é˜Ÿä¸­å·¥ä½œï¼Œæˆ–è€…æ‚¨çš„é¡¹ç›®æ˜¯å…¬å¼€çš„ï¼Œåˆ™å¯èƒ½éœ€è¦åœ¨ä¸“ç”¨çš„æ„å»ºæœºå™¨ä¸Šå®‰è£…GitLab Runnerã€‚
æ­¤ç‰¹å®šæ•™ç¨‹ä¸­ä½¿ç”¨çš„æµ‹è¯•é¡¹ç›®å¯åœ¨[è¿™é‡Œ](https://gitlab.com/AngeloStavrow/gitlab-ci-for-ios-projects)ä¸‹è½½ï¼Œä½†æ˜¯é¡¹ç›®å¸¦çš„Runnerå·²ç»æ²¡æœ‰äº†ã€‚å¦‚æœåœ¨æ„å»ºè¾“å‡ºä¸­çœ‹åˆ°è¯ä¹¦æ–‡ä»¶é”™è¯¯ï¼Œåˆ™å¯èƒ½éœ€è¦å‘.gitlab-ci.ymlæ–‡ä»¶çš„è„šæœ¬ä¸­æ·»åŠ [ä¸€äº›å‚æ•°](https://coderwall.com/p/rv2lgw/use-xcodebuild-to-build-workspace-vs-project)ã€‚